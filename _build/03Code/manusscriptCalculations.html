---
redirect_from:
  - "/03code/manusscriptcalculations"
interact_link: content/03Code/manusscriptCalculations.ipynb
kernel_name: python3
kernel_path: content/03Code
has_widgets: false
title: |-
  Example
pagenum: 2
prev_page:
  url: /02Abstract/abstract.html
next_page:
  url: 
suffix: .ipynb
search: na nb et al figures size show repertoires frac figure albrecht b pts repertoire save note code sorenson sampling increases amele data si tessema unpublished notes n ab overlap toggle not want errors reproductions paper therefore unequal possible calculations sampled jaccard studies using ariquemes wosera mugil case happens sizes fix bayesian reproduction notebook global folder called able run output based stochastic draws wont exactly those identical trends simulation theory equal comments next cell rebuild inference file standard otherwise just load take few minutes compute values manuscript suppose s sequences shared between rates expected coefficients populations fully less bro posterior consistency

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Example</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Bayesian-Repertoire-Overlap---Reproduction-Notebook">Bayesian Repertoire Overlap - Reproduction Notebook<a class="anchor-link" href="#Bayesian-Repertoire-Overlap---Reproduction-Notebook"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">hypergeom</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binned_statistic</span> <span class="k">as</span> <span class="n">binsta</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">logsumexp</span>
<span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">palettable</span> <span class="k">as</span> <span class="nn">pal</span>
<span class="n">clrx</span> <span class="o">=</span> <span class="n">pal</span><span class="o">.</span><span class="n">cartocolors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">Prism_10</span><span class="o">.</span><span class="n">mpl_colors</span>
<span class="n">clr</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clrx</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">clr2</span> <span class="o">=</span> <span class="n">pal</span><span class="o">.</span><span class="n">cartocolors</span><span class="o">.</span><span class="n">sequential</span><span class="o">.</span><span class="n">agSunset_7</span><span class="o">.</span><span class="n">mpl_colors</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Global-toggle-to-save-/-not-save-figures">Global toggle to save / not-save figures<a class="anchor-link" href="#Global-toggle-to-save-/-not-save-figures"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">isSaveFigures</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note 1: Make a folder called "figures" if you want to be able to run this code with no errors and output reproductions of figures in the paper. :)</p>
<p>Note 2: Reproductions of Figures 3 and 4 are based on stochastic draws and therefore the figures won't look <em>exactly</em> like those of the paper, but will be identical in the trends that they show.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simulation">Simulation<a class="anchor-link" href="#Simulation"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># CCP, the Coupon Collector&#39;s Problem</span>
<span class="k">def</span> <span class="nf">ccp_sample</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span><span class="n">c</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Draw overlap</span>
<span class="k">def</span> <span class="nf">nab_sample</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">hypergeometric</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">pool</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">)</span>
    <span class="n">nab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">hypergeometric</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="n">pool</span><span class="o">-</span><span class="n">sa</span><span class="p">,</span><span class="n">nb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nab</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Overlap between two PCRs of depth c and overlap s</span>
<span class="k">def</span> <span class="nf">pcr_sample</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
    <span class="n">na</span> <span class="o">=</span> <span class="n">ccp_sample</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">ccp_sample</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nab_sample</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">),</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Draw na and nb samples from two populations of size pool_a and pool_b, with true overlap s</span>
<span class="c1"># and return empirical overlap between na and nb</span>
<span class="c1"># note that this is basically the same as nab_sample, but with two different size pools!</span>
<span class="k">def</span> <span class="nf">nab_sample_unequal</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">):</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">hypergeometric</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">pool_a</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">)</span>
    <span class="n">nab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">hypergeometric</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="n">pool_b</span><span class="o">-</span><span class="n">sa</span><span class="p">,</span><span class="n">nb</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nab</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Theory">Theory<a class="anchor-link" href="#Theory"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">p_ccp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">row</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])):</span>
            <span class="n">p</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="n">pool</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">pool</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Code for equal-size repertoires</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">p_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># reference: hypergeom.pmf(outcome, Total, hits, Draws, loc=0)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># p_sa is the probability that we&#39;d get sa from the overlap (s), just in na draws of a</span>
        <span class="n">p_sa</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">pool</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">)</span>
        <span class="c1"># p_nab_given_sa is the probability of getting that nab, given sa</span>
        <span class="n">p_nab_given_sa</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">nb</span><span class="p">)</span>
        <span class="n">p_s</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p_sa</span><span class="p">,</span><span class="n">p_nab_given_sa</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p_s</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p_s</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">e_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">p_s</span> <span class="o">=</span> <span class="n">p_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">p_s</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">credible_interval</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pct</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">p_s</span> <span class="o">=</span> <span class="n">p_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">p_s</span><span class="p">)</span>
    <span class="n">ccdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">p_s</span><span class="p">)))</span>
    <span class="c1"># adjust for fractions vs percents; put everything as a fraction</span>
    <span class="k">if</span> <span class="n">pct</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pct</span> <span class="o">=</span> <span class="n">pct</span><span class="o">/</span><span class="mi">100</span>
    <span class="n">cutoff</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pct</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="c1"># get the lower bound. </span>
    <span class="c1"># it&#39;s the first index at which cdf ≥ cutoff</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cdf</span> <span class="o">&gt;=</span> <span class="n">cutoff</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># get the upper bound</span>
    <span class="c1"># it&#39;s the first index at which ccdf ≥ 0.05</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ccdf</span> <span class="o">&gt;=</span> <span class="n">cutoff</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">upper</span><span class="o">=</span><span class="n">pool</span>
    <span class="n">expectation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">p_s</span><span class="p">)</span>
    <span class="c1"># Sanity and indexing check: uncomment this line to see true tail probability ≤ 0.05</span>
    <span class="c1"># print([cdf[lower-1],(1-ccdf[upper+1])])</span>
    <span class="k">return</span> <span class="n">lower</span><span class="p">,</span><span class="n">expectation</span><span class="p">,</span><span class="n">upper</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">p_nab_given_c</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">pna</span> <span class="o">=</span> <span class="n">p_ccp</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">pnb</span> <span class="o">=</span> <span class="n">p_ccp</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">nas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pna</span><span class="p">))</span>
    <span class="n">nbs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pnb</span><span class="p">))</span>
    <span class="n">p_gen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="n">nas</span><span class="p">:</span>
        <span class="n">p_sa</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">pool</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="n">nbs</span><span class="p">:</span>
            <span class="n">pna_pnb</span> <span class="o">=</span> <span class="n">pna</span><span class="p">[</span><span class="n">na</span><span class="p">]</span> <span class="o">*</span> <span class="n">pnb</span><span class="p">[</span><span class="n">nb</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">nab</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">)):</span>
                <span class="n">p_nab_given_sa</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">nb</span><span class="p">)</span>
                <span class="n">p_nab_given_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p_sa</span><span class="p">,</span><span class="n">p_nab_given_sa</span><span class="p">)</span>
                <span class="n">p_gen</span><span class="p">[</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_nab_given_s</span> <span class="o">*</span> <span class="n">pna_pnb</span>
    <span class="k">return</span> <span class="n">p_gen</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">p_shat_given_sc</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">shat</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">masses</span> <span class="o">=</span> <span class="n">p_nab_given_c</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.99</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Swapping to Monte Carlo&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p_shat_given_sc_montecarlo</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">shat</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">binsta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">shat</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">masses</span><span class="p">),</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hist</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">p_shat_given_sc_montecarlo</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">shat</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">n_mc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)):</span>
    <span class="n">masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_mc</span><span class="p">):</span>
        <span class="n">nab</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span> <span class="o">=</span> <span class="n">pcr_sample</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
        <span class="n">masses</span><span class="p">[</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">binsta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">shat</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">masses</span><span class="o">/</span><span class="n">n_mc</span><span class="p">),</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hist</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compute_all_estimates</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">shat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">nab</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nb</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
                <span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shat</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Code for unequal-size repertoires</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">p_overlap_unequal</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">):</span>
    <span class="c1"># all loops are in terms of pool_a, which is assumed to be ≤ pool_b. </span>
    <span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># reference: hypergeom.pmf(outcome, Total, hits, Draws, loc=0)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># p_sa is the probability that we&#39;d get sa from the overlap (s), just in na draws of a</span>
        <span class="n">p_sa</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">pool_a</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">)</span>
        <span class="c1"># p_nab_given_sa is the probability of getting that nab, given sa</span>
        <span class="n">p_nab_given_sa</span> <span class="o">=</span> <span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_b</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">nb</span><span class="p">)</span>
        <span class="n">p_s</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p_sa</span><span class="p">,</span><span class="n">p_nab_given_sa</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p_s</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p_s</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">e_overlap_unequal</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">):</span>
    <span class="c1"># TODO. Code expects that pool_b &gt; pool_a...</span>
    <span class="n">p_s</span> <span class="o">=</span> <span class="n">p_overlap_unequal</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">p_s</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Toggle the comments in the next cell if you want to rebuild the inference file for standard size-60 repertoires. Otherwise, just save the time and load it. It may take a few minutes to compute all the possible values.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># shat = compute_all_estimates(pool=60)</span>
<span class="c1"># np.save(&#39;shat_60.npy&#39;,shat)</span>
<span class="n">shat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;shat_60.npy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Manuscript-calculations">Manuscript calculations<a class="anchor-link" href="#Manuscript-calculations"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Suppose that $s=5$ sequences are shared between two repertoires of size 10 each, and that the repertoires are sampled at rates $n_a=n_b=9$. What are the expected Jaccard and Sorenson coefficients? (Note: Were the populations to be fully sampled, Jaccard would be $\frac{1}{3}$ and Sorenson would be $\frac{1}{2}$.)</li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nabs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">na</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">nb</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">overlap</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nabs</span><span class="p">)):</span>
    <span class="n">nabs</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nab_sample</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="o">=</span><span class="n">nb</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">total</span><span class="p">)</span>
<span class="n">sor</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nabs</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
<span class="n">sor_full</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">overlap</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">+</span><span class="n">total</span><span class="p">)</span>
<span class="n">jac</span> <span class="o">=</span> <span class="n">nabs</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="o">-</span><span class="n">nabs</span><span class="p">)</span>
<span class="n">jac_full</span> <span class="o">=</span> <span class="n">overlap</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">+</span><span class="n">total</span><span class="o">-</span><span class="n">overlap</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Sorens. = </span><span class="si">{:.3f}</span><span class="se">\t</span><span class="s2">Fully sampled = </span><span class="si">{:.3f}</span><span class="se">\t</span><span class="s2">Error = </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sor</span><span class="p">),</span><span class="n">sor_full</span><span class="p">,(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sor</span><span class="p">)</span><span class="o">-</span><span class="n">sor_full</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">sor_full</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Jaccard = </span><span class="si">{:.3f}</span><span class="se">\t</span><span class="s2">Fully sampled = </span><span class="si">{:.3f}</span><span class="se">\t</span><span class="s2">Error = </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jac</span><span class="p">),</span><span class="n">jac_full</span><span class="p">,(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jac</span><span class="p">)</span><span class="o">-</span><span class="n">jac_full</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">jac_full</span><span class="p">))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean Sorens. = 0.450	Fully sampled = 0.500	Error = -10.05%
Mean Jaccard = 0.293	Fully sampled = 0.333	Error = -12.07%
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2a. How many possible calculations are there when $n_a = n_b = 60$?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">61</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">61</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">nab</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ctr</span> <span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> possible combinations of na, nb, and nab.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctr</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 77410 possible combinations of na, nb, and nab.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2b. For how many of these is Sorenson/PTS less than BRO?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ctrr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">61</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">61</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">nab</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">pts</span> <span class="o">=</span> <span class="mi">120</span><span class="o">*</span><span class="n">nab</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
            <span class="n">bro</span> <span class="o">=</span> <span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bro</span> <span class="o">&gt;=</span> <span class="n">pts</span><span class="p">):</span>
                <span class="n">ctrr</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> combinations of na, nb, and nab where BRO ≥ PTS.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctrr</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This covers </span><span class="si">{:.3f}% o</span><span class="s2">f cases.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctrr</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">ctr</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 77297 combinations of na, nb, and nab where BRO ≥ PTS.
This covers 99.854% of cases.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Figures">Figures<a class="anchor-link" href="#Figures"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-2:-Show-a-posterior">Figure 2: Show a posterior<a class="anchor-link" href="#Figure-2:-Show-a-posterior"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">na</span> <span class="o">=</span> <span class="mi">47</span>
<span class="n">nb</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">nab</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">pool</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">pts</span> <span class="o">=</span> <span class="n">pool</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">p_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
<span class="n">lower</span><span class="p">,</span><span class="n">shat</span><span class="p">,</span><span class="n">upper</span> <span class="o">=</span> <span class="n">credible_interval</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="n">pool</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">upper</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">lower</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">er</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">er</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">shat</span><span class="o">-</span><span class="n">lower</span>
<span class="n">er</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper</span><span class="o">-</span><span class="n">shat</span>

<span class="n">fig</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ps</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;posterior distribution&#39;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
        <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">shat</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
           <span class="n">facecolor</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
           <span class="n">edgecolor</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
           <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
           <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bayesian estimate&#39;</span><span class="p">,</span>
          <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;90</span><span class="si">% c</span><span class="s1">redible interval&#39;</span><span class="p">,)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">ALMOST_BLACK_V</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sorenson-Dice coefficient, S&#39;</span><span class="p">,</span>
       <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Posterior probability P(s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig2.pdf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/03Code/manusscriptCalculations_34_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.tools</span> <span class="k">as</span> <span class="nn">tls</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">plot</span><span class="p">,</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">init_notebook_mode</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">config</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;showLink&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;displayModeBar&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
 
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ps</span><span class="p">,</span> 
                         <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
                         <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(121, 178, 81)&#39;</span><span class="p">),</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;posterior distribuiton&quot;</span><span class="p">,</span>
                         <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">shat</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                         <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bayesian Estimate&quot;</span><span class="p">,</span> 
                         <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                     <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgb(255,255,255)&quot;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(121, 178, 81)&#39;</span><span class="p">))))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">pts</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                         <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                         <span class="n">marker_symbol</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Sorenson-Dice coefficient, S&quot;</span><span class="p">,</span> 
                         <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                     <span class="n">color</span><span class="o">=</span><span class="s2">&quot;rgb(1,1,1)&quot;</span><span class="p">,)))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                         <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                         <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgba(121, 178, 81, 0.1)&#39;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span><span class="p">),</span>
                         <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;tozeroy&#39;</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;90</span><span class="si">% c</span><span class="s2">red&quot;</span><span class="p">))</span>


<span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;plotly_figures/fig2.html&#39;</span><span class="p">,</span> <span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="p">)</span>

<span class="c1">#ThebeLab</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;fig2.html&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-latest.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>

</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
fig2.html
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-3---Consistency:-accuracy-improves-as-sampling-increases">Figure 3 - Consistency: accuracy improves as sampling increases<a class="anchor-link" href="#Figure-3---Consistency:-accuracy-improves-as-sampling-increases"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span>
<span class="n">shat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;shat_60.npy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reps</span><span class="o">=</span><span class="mi">4</span>
<span class="n">recovered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="n">reps</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">planted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="n">reps</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">recovered_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="n">reps</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">nas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="k">for</span> <span class="n">idxa</span><span class="p">,</span><span class="n">na</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nas</span><span class="p">):</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">na</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">nab</span> <span class="o">=</span> <span class="n">nab_sample</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">)</span>
            <span class="n">planted</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
            <span class="n">recovered</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">)</span>
            <span class="n">recovered_pts</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idxa</span><span class="p">,</span><span class="n">na</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nas</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">idxa</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">planted</span><span class="p">[</span><span class="n">idxa</span><span class="p">,:,:],</span><span class="n">recovered</span><span class="p">[</span><span class="n">idxa</span><span class="p">,:,:],</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BRO&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">),</span>
               <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">clr2</span><span class="p">[</span><span class="n">idxa</span><span class="p">],</span>
               <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
               <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
               <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
              <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">planted</span><span class="p">[</span><span class="n">idxa</span><span class="p">,:,:],</span><span class="n">pool</span><span class="o">*</span><span class="n">recovered_pts</span><span class="p">[</span><span class="n">idxa</span><span class="p">,:,:],</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span>
               <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
               <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
               <span class="n">s</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
              <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pool</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pool</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Estimated overlap $\hat s$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;True overlap $s$&#39;</span><span class="p">)</span>
    <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.02</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> samples&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr2</span><span class="p">[</span><span class="n">idxa</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig3.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>&#39;c&#39; argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with &#39;x&#39; &amp; &#39;y&#39;.  Please use a 2-D array with a single row if you really want to specify the same RGB or RGBA value for all points.
findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans.
&#39;c&#39; argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with &#39;x&#39; &amp; &#39;y&#39;.  Please use a 2-D array with a single row if you really want to specify the same RGB or RGBA value for all points.
&#39;c&#39; argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with &#39;x&#39; &amp; &#39;y&#39;.  Please use a 2-D array with a single row if you really want to specify the same RGB or RGBA value for all points.
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/03Code/manusscriptCalculations_39_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-3---Credible-intervals-tighten-as-sampling-increases">Figure 3 - Credible intervals tighten as sampling increases<a class="anchor-link" href="#Figure-3---Credible-intervals-tighten-as-sampling-increases"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span>
<span class="n">shat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;shat_60.npy&#39;</span><span class="p">)</span>
<span class="n">planted2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">recovered2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="n">nas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="k">for</span> <span class="n">idxa</span><span class="p">,</span><span class="n">na</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nas</span><span class="p">):</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">na</span>
    <span class="n">idxb</span> <span class="o">=</span> <span class="n">idxa</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">planted2</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxb</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">nab</span> <span class="o">=</span> <span class="n">nab_sample</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">)</span>
        <span class="n">lower</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxb</span><span class="p">,</span><span class="n">s</span><span class="p">],</span> <span class="n">recovered2</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxb</span><span class="p">,</span><span class="n">s</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxb</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">credible_interval</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">)</span>
        <span class="n">es</span> <span class="o">=</span> <span class="n">e_overlap</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">)</span>
        <span class="n">recovered2</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxb</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">es</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idxa</span><span class="p">,</span><span class="n">na</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nas</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">idxa</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">planted2</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxa</span><span class="p">,</span><span class="n">sub</span><span class="p">],</span><span class="n">recovered2</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxa</span><span class="p">,</span><span class="n">sub</span><span class="p">],</span>
               <span class="n">yerr</span> <span class="o">=</span> <span class="p">[</span><span class="n">recovered2</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxa</span><span class="p">,</span><span class="n">sub</span><span class="p">]</span><span class="o">-</span><span class="n">lower</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxa</span><span class="p">,</span><span class="n">sub</span><span class="p">],</span><span class="n">upper</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxa</span><span class="p">,</span><span class="n">sub</span><span class="p">]</span><span class="o">-</span><span class="n">recovered2</span><span class="p">[</span><span class="n">idxa</span><span class="p">,</span><span class="n">idxa</span><span class="p">,</span><span class="n">sub</span><span class="p">]],</span>  
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;overlap ± cred. interval&#39;</span><span class="p">,</span>
               <span class="n">c</span> <span class="o">=</span> <span class="n">clr2</span><span class="p">[</span><span class="n">idxa</span><span class="p">],</span>
                <span class="n">capsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
              <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;reference&#39;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pool</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pool</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Estimated overlap $\hat s$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;True overlap $s$&#39;</span><span class="p">)</span>
    <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.49</span><span class="p">,</span><span class="o">-</span><span class="mf">0.01</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> samples&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr2</span><span class="p">[</span><span class="n">idxa</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig4.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/03Code/manusscriptCalculations_42_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-6----Decrease-in-error-of-estimates-as-sampling-increases">Figure 6 -  Decrease in error of estimates as sampling increases<a class="anchor-link" href="#Figure-6----Decrease-in-error-of-estimates-as-sampling-increases"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">shat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;shat_60.npy&#39;</span><span class="p">)</span>
<span class="n">hist_error</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">pool</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">ss</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">cc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">144</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
    <span class="n">hist_error</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
        <span class="n">hist_error</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">idx</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p_shat_given_sc</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">shat</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="mf">2.3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idc</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cc</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.29</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="mi">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">hist_error</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span>
              <span class="n">color</span> <span class="o">=</span> <span class="n">clr</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
               <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
               <span class="n">ec</span> <span class="o">=</span> <span class="n">ALMOST_BLACK_V</span>
              <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Estimated overlap, $\hat</span><span class="si">{s}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability of $\hat</span><span class="si">{s}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.31</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">,</span> <span class="s1">&#39;c = </span><span class="si">{}</span><span class="s1"> colonies&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">idc</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.30</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ignoreLegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig6.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Reprocess-past-studies">Reprocess past studies<a class="anchor-link" href="#Reprocess-past-studies"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bro</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">lci</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">def</span> <span class="nf">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">):</span>
    <span class="n">lower</span><span class="p">,</span><span class="n">expectation</span><span class="p">,</span><span class="n">upper</span> <span class="o">=</span> <span class="n">credible_interval</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">upper</span><span class="o">-</span><span class="n">lower</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Amele (Barry et al 2007; using data from SI of Albrecht et al 2010)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfAme_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/amele.XLS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dfAme</span> <span class="o">=</span> <span class="n">dfAme_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfAme_all</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;AMELE&quot;</span><span class="p">]</span>
<span class="n">dfAme</span> <span class="o">=</span> <span class="n">dfAme</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="nb">len</span><span class="p">(</span><span class="n">dfAme</span><span class="p">)]</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfAme</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">dfAme</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">nab</span><span class="p">)</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
        <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;ame&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;ame&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;ame&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean samples per parasite: </span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">na</span><span class="p">[:</span><span class="n">n</span><span class="p">])))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Mean samples per parasite: 15.6
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Kilifi (Bull et al 2007; using data from SI of Albrecht et al 2010)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfKil</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/kilifi.xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfKil</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfKil</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">60</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">60</span> <span class="k">else</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">dfKil</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># note that this file needs a and b swapped to get the lower diagonal</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
        <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
        <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span> 
        <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;kilifi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;kilifi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;kilifi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Brazil (Albrecht 2010)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfBra</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/allbrazil.xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfBra</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfBra</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">60</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">60</span> <span class="k">else</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">dfBra</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
        <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;brazil&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;brazil&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;brazil&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ariquemes 1  (Albrecht 2010)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;113&quot;</span><span class="p">,</span><span class="s2">&quot;121&quot;</span><span class="p">,</span><span class="s2">&quot;122&quot;</span><span class="p">,</span><span class="s2">&quot;123&quot;</span><span class="p">,</span><span class="s2">&quot;127&quot;</span><span class="p">,</span><span class="s2">&quot;128&quot;</span><span class="p">,</span><span class="s2">&quot;153&quot;</span><span class="p">,</span><span class="s2">&quot;154&quot;</span><span class="p">]</span>
<span class="n">dfAri</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/ariquemes_1.xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfAri</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfAri</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">60</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">60</span> <span class="k">else</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">dfAri</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">nab</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

<span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pars</span><span class="p">:</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dfAri</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>
    <span class="n">ida</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dfAri</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">idz</span> <span class="o">=</span> <span class="n">ida</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ida</span><span class="p">,</span><span class="n">idz</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">idz</span><span class="p">):</span>
            <span class="n">q</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
            <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
            <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;ari&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;ari&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;ari&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ariquemes 2  (Albrecht 2010)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfAri2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/ariquemes_2.xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfAri2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfAri2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">60</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">60</span> <span class="k">else</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">dfAri2</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
        <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;ari2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;ari2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;ari2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wosera (Tessema et al 2014)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfWos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/tessema_wosera.xlsx&#39;</span><span class="p">)</span>
<span class="c1"># compute na, the number of sequences per parasite</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">dfWos</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># number of parasites</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
<span class="c1"># compute nab, the number of shared sequences for each pair of parasites</span>
<span class="n">pars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dfWos</span><span class="p">)</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">para</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span><span class="p">,</span><span class="n">parb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
        <span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">dfWos</span><span class="p">[</span><span class="n">para</span><span class="p">]</span><span class="o">+</span><span class="n">dfWos</span><span class="p">[</span><span class="n">parb</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
        <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;wosera&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;wosera&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;wosera&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Amele (data from SI of Tessema et al 2014)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfAme2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/tessema_amele.xlsx&#39;</span><span class="p">)</span>
<span class="c1"># compute na, the number of sequences per parasite</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">dfAme2</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># number of parasites</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
<span class="c1"># compute nab, the number of shared sequences for each pair of parasites</span>
<span class="n">pars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dfAme2</span><span class="p">)</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">para</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span><span class="p">,</span><span class="n">parb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
        <span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">dfAme2</span><span class="p">[</span><span class="n">para</span><span class="p">]</span><span class="o">+</span><span class="n">dfAme2</span><span class="p">[</span><span class="n">parb</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
        <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;amele_tessema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;amele_tessema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;amele_tessema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mugil (Tessema et al 2014)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfMug</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data/tessema_mugil.xlsx&#39;</span><span class="p">)</span>
<span class="c1"># compute na, the number of sequences per parasite</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">dfMug</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># number of parasites</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
<span class="c1"># compute nab, the number of shared sequences for each pair of parasites</span>
<span class="n">pars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dfMug</span><span class="p">)</span>
<span class="n">nab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">para</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span><span class="p">,</span><span class="n">parb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pars</span><span class="p">):</span>
        <span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">dfMug</span><span class="p">[</span><span class="n">para</span><span class="p">]</span><span class="o">+</span><span class="n">dfMug</span><span class="p">[</span><span class="n">parb</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dummp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">dummy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]])</span>
        <span class="n">dummz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">+</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">]))</span>
        <span class="n">dummp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lenci</span><span class="p">(</span><span class="n">na</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">na</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]))</span>
<span class="n">bro</span><span class="p">[</span><span class="s2">&quot;mugil&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<span class="n">pts</span><span class="p">[</span><span class="s2">&quot;mugil&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummz</span><span class="p">)</span>
<span class="n">lci</span><span class="p">[</span><span class="s2">&quot;mugil&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">thr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">61</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ari&quot;</span><span class="p">,</span><span class="s2">&quot;ari2&quot;</span><span class="p">,</span><span class="s2">&quot;brazil&quot;</span><span class="p">,</span><span class="s2">&quot;ame&quot;</span><span class="p">,</span><span class="s2">&quot;kilifi&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">pts</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">]</span>
<span class="n">clr3</span> <span class="o">=</span> <span class="n">pal</span><span class="o">.</span><span class="n">cmocean</span><span class="o">.</span><span class="n">diverging</span><span class="o">.</span><span class="n">Balance_7</span><span class="o">.</span><span class="n">mpl_colors</span>
<span class="n">clr3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">clr3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">clr3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">clr3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">bands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">bands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bands</span><span class="p">,</span><span class="n">bands</span><span class="o">+</span><span class="mi">15</span><span class="p">]))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax8</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ax9</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">]</span>
<span class="n">dat</span> <span class="o">=</span> <span class="p">[</span><span class="n">pts</span><span class="p">,</span><span class="n">bro</span><span class="p">]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>
    <span class="n">mp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">dat</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">lci</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">thr</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">/</span><span class="n">sc</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">],</span><span class="n">whis</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">97.5</span><span class="p">],</span><span class="n">flierprops</span><span class="o">=</span><span class="n">fp</span><span class="p">,</span> <span class="n">medianprops</span><span class="o">=</span><span class="n">mp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sc</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">60</span><span class="p">])</span>
    <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ignoreLegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;Ariq. clones   &quot;</span><span class="p">,</span><span class="s2">&quot;   Ariq. isol.&quot;</span><span class="p">,</span><span class="s2">&quot;Brazil&quot;</span><span class="p">,</span><span class="s2">&quot;Amele&quot;</span><span class="p">,</span><span class="s2">&quot;Kilifi&quot;</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PTS X 60&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Estimated overlap $\hat</span><span class="si">{s}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="n">bxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax8</span><span class="p">,</span><span class="n">ax9</span><span class="p">]</span>

<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ame&quot;</span><span class="p">,</span><span class="s2">&quot;ari&quot;</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Amele&quot;</span><span class="p">,</span> <span class="s2">&quot;Ariq. clones&quot;</span><span class="p">]</span>
<span class="n">ds</span><span class="o">=</span><span class="mi">2</span>
<span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax8</span><span class="p">,</span><span class="n">ax9</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ids</span><span class="p">,</span><span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">bxs</span><span class="p">[</span><span class="n">ids</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bro&quot;</span><span class="p">:</span><span class="n">bro</span><span class="p">[</span><span class="n">sample</span><span class="p">],</span> <span class="s2">&quot;unc&quot;</span><span class="p">:</span><span class="n">lci</span><span class="p">[</span><span class="n">sample</span><span class="p">]})</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bands</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;unc&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;unc&quot;</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s2">&quot;bro&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">bins</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="n">ds</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="n">ds</span><span class="p">),</span><span class="n">h</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr3</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">ids</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ignoreLegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ignoreLegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;CI Width (uncertainty)&quot;</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.39</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">leg</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>   
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
    
<span class="n">yscale</span> <span class="o">=</span> <span class="n">ax9</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">())</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.62</span><span class="o">*</span><span class="n">ax8</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.05</span><span class="o">*</span><span class="p">(</span><span class="n">yscale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">yscale</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">yscale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
<span class="n">ax9</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.31</span><span class="o">*</span><span class="n">ax9</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.05</span><span class="o">*</span><span class="p">(</span><span class="n">yscale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">yscale</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">yscale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">size</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/fig5.pdf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/larremore/Desktop/Dropbox/python/venv/lib/python3.7/site-packages/matplotlib/font_manager.py:1328: UserWarning: findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/03Code/manusscriptCalculations_65_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Supplemental-Figure:-What-if-$n_a-\neq-n_b$-?">Supplemental Figure: What if $n_a \neq n_b$ ?<a class="anchor-link" href="#Supplemental-Figure:-What-if-$n_a-\neq-n_b$-?"> </a></h2><p>Reviewers made a good suggestion to show the case when $n_a$ is much larger than $n_b$. What happens in this case?</p>
<p>They also asked what happens when the population sizes are unequal, and not 60.</p>
<p>We therefore consider conditions:</p>
<ul>
<li>1 - $n_a = n_b = 40$</li>
<li>2 - $n_a=10, n_b=40$</li>
<li>A - total repertoire sizes are each 60</li>
<li>B - one repertoire of size 60 and the other of size 120</li>
</ul>
<p>We show plots for 1A, 1B, 2A, 2B to show the various combinations.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reps</span><span class="o">=</span><span class="mi">2</span>
<span class="n">pool_a</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">recovered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="n">reps</span><span class="p">,</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">planted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="n">reps</span><span class="p">,</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">recovered_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="n">reps</span><span class="p">,</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># 1A</span>
<span class="n">na</span><span class="p">,</span><span class="n">nb</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span><span class="mi">40</span>
<span class="n">pool_b</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
        <span class="n">nab</span> <span class="o">=</span> <span class="n">nab_sample_unequal</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">planted</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">recovered</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_overlap_unequal</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">recovered_pts</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
<span class="c1"># 1B</span>
<span class="n">na</span><span class="p">,</span><span class="n">nb</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span><span class="mi">40</span>
<span class="n">pool_b</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
        <span class="n">nab</span> <span class="o">=</span> <span class="n">nab_sample_unequal</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">planted</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">recovered</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_overlap_unequal</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">recovered_pts</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
<span class="c1"># 2A</span>
<span class="n">na</span><span class="p">,</span><span class="n">nb</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">40</span>
<span class="n">pool_b</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
        <span class="n">nab</span> <span class="o">=</span> <span class="n">nab_sample_unequal</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">planted</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">recovered</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_overlap_unequal</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">recovered_pts</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
<span class="c1"># 2B</span>
<span class="n">na</span><span class="p">,</span><span class="n">nb</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">40</span>
<span class="n">pool_b</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pool_a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
        <span class="n">nab</span> <span class="o">=</span> <span class="n">nab_sample_unequal</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">planted</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">recovered</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_overlap_unequal</span><span class="p">(</span><span class="n">na</span><span class="p">,</span><span class="n">nb</span><span class="p">,</span><span class="n">nab</span><span class="p">,</span><span class="n">pool_a</span><span class="p">,</span><span class="n">pool_b</span><span class="p">)</span>
        <span class="n">recovered_pts</span><span class="p">[</span><span class="n">case</span><span class="p">,</span><span class="n">rep</span><span class="p">,</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">nab</span><span class="o">/</span><span class="p">(</span><span class="n">na</span><span class="o">+</span><span class="n">nb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">case</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">case</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">case</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">case</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">planted</span><span class="p">[</span><span class="n">case</span><span class="p">,:,:],</span><span class="n">recovered</span><span class="p">[</span><span class="n">case</span><span class="p">,:,:],</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BRO&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">),</span>
               <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">clr2</span><span class="p">[</span><span class="n">case</span><span class="p">],</span>
               <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
               <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
               <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
              <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">planted</span><span class="p">[</span><span class="n">case</span><span class="p">,:,:],</span><span class="n">pool_a</span><span class="o">*</span><span class="n">recovered_pts</span><span class="p">[</span><span class="n">case</span><span class="p">,:,:],</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span>
               <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
               <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
               <span class="n">s</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
              <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pool_a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pool_a</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Estimated overlap $\hat s$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;True overlap $s$&#39;</span><span class="p">)</span>
    <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="mi">35</span><span class="o">/</span><span class="mi">60</span><span class="p">],</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">case</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;pop. a: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="se">\n</span><span class="s1">pop. b: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="s1">&#39;</span>
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr2</span><span class="p">[</span><span class="n">case</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">case</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;pop. a: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="se">\n</span><span class="s1">pop. b: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="s1">&#39;</span>
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr2</span><span class="p">[</span><span class="n">case</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">case</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;pop. a: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="se">\n</span><span class="s1">pop. b: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="s1">&#39;</span>
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr2</span><span class="p">[</span><span class="n">case</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">case</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;pop. a: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="se">\n</span><span class="s1">pop. b: </span><span class="si">{}</span><span class="s1"> samples from total size </span><span class="si">{}</span><span class="s1">&#39;</span>
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr2</span><span class="p">[</span><span class="n">case</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/suppfig_1_unequal_samples_and_sizes.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">na</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/larremore/Desktop/Dropbox/python/venv/lib/python3.7/site-packages/matplotlib/font_manager.py:1328: UserWarning: findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/03Code/manusscriptCalculations_68_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Unpublished-Notes:-Uncertainty-for-empirical-overlap-studies">Unpublished Notes: Uncertainty for empirical overlap studies<a class="anchor-link" href="#Unpublished-Notes:-Uncertainty-for-empirical-overlap-studies"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Wosera,-Mugil,-Amele">Wosera, Mugil, Amele<a class="anchor-link" href="#Wosera,-Mugil,-Amele"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">thr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">61</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wosera&quot;</span><span class="p">,</span><span class="s2">&quot;mugil&quot;</span><span class="p">,</span><span class="s2">&quot;amele_tessema&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="n">pts</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">dat</span> <span class="o">=</span> <span class="p">[</span><span class="n">pts</span><span class="p">,</span><span class="n">bro</span><span class="p">,</span><span class="n">bro</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PTS&quot;</span><span class="p">,</span> <span class="s2">&quot;BRO&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>
    <span class="n">mp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">dat</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">lci</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">thr</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">/</span><span class="n">sc</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">],</span><span class="n">whis</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">97.5</span><span class="p">],</span><span class="n">flierprops</span><span class="o">=</span><span class="n">fp</span><span class="p">,</span> <span class="n">medianprops</span><span class="o">=</span><span class="n">mp</span><span class="p">)</span>
<span class="c1">#     ax.violinplot([dat[idx][x][lci[x]&lt;61]/sc for x in samples])</span>
    <span class="k">if</span> <span class="n">sc</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="o">/</span><span class="n">sc</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;Wosera&quot;</span><span class="p">,</span><span class="s2">&quot;Mugil&quot;</span><span class="p">,</span><span class="s2">&quot;Amele&quot;</span><span class="p">])</span>
    <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pairwise type sharing&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Bayesian rep. overlap (proportion)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/tessema2015remake.pdf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>No handles with labels found to put in legend.
No handles with labels found to put in legend.
/Users/larremore/Desktop/Dropbox/python/venv/lib/python3.7/site-packages/matplotlib/font_manager.py:1328: UserWarning: findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/03Code/manusscriptCalculations_71_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clr3</span> <span class="o">=</span> <span class="n">pal</span><span class="o">.</span><span class="n">cmocean</span><span class="o">.</span><span class="n">diverging</span><span class="o">.</span><span class="n">Balance_7</span><span class="o">.</span><span class="n">mpl_colors</span>
<span class="n">clr3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">clr3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">clr3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">clr3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">bands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">bands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bands</span><span class="p">,</span><span class="n">bands</span><span class="o">+</span><span class="mi">15</span><span class="p">]))</span>
<span class="c1"># samples = [&quot;ari&quot;,&quot;ari2&quot;,&quot;brazil&quot;,&quot;ame&quot;,&quot;kilifi&quot;,&quot;thies&quot;]</span>
<span class="c1"># names = [&quot;Ariquemes clones&quot;, &quot;Ariquemes isolates&quot;, &quot;Brazil&quot;, &quot;Amele&quot;, &quot;Kilifi&quot;,&quot;Thies&quot;]</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;amele_tessema&quot;</span><span class="p">,</span><span class="s2">&quot;wosera&quot;</span><span class="p">,</span><span class="s2">&quot;mugil&quot;</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Amele&quot;</span><span class="p">,</span> <span class="s2">&quot;Wosera&quot;</span><span class="p">,</span><span class="s2">&quot;Mugil&quot;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ids</span><span class="p">,</span><span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">ids</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bro&quot;</span><span class="p">:</span><span class="n">bro</span><span class="p">[</span><span class="n">sample</span><span class="p">],</span> <span class="s2">&quot;unc&quot;</span><span class="p">:</span><span class="n">lci</span><span class="p">[</span><span class="n">sample</span><span class="p">]})</span>
    <span class="n">binz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">61</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bands</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;unc&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;unc&quot;</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s2">&quot;bro&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">62</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">binz</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr3</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="c1">#         ax.bar(binz,h,color=clr[2],label=str(b))</span>
    <span class="n">yscale</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">0.8</span><span class="o">*</span><span class="n">yscale</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="n">ids</span><span class="p">]),</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ids</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ignoreLegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ignoreLegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Uncertainty&quot;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.25</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Bayesian Repertoire Overlap&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/uncertainty_barcharts.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/larremore/Desktop/Dropbox/python/venv/lib/python3.7/site-packages/matplotlib/font_manager.py:1328: UserWarning: findfont: Font family [&#39;sans-serif&#39;] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/03Code/manusscriptCalculations_72_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Unpublished-notes:-Distributions-of-errors-from-PCR-vs-c">Unpublished notes: Distributions of errors from PCR vs c<a class="anchor-link" href="#Unpublished-notes:-Distributions-of-errors-from-PCR-vs-c"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hist_error_2</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ss</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">]</span>
<span class="n">pool</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">cc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">192</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
    <span class="n">hist_error_2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
        <span class="n">hist_error_2</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">idx</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p_shat_given_sc</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">shat</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pool</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">hist_error_2</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span>
              <span class="n">color</span> <span class="o">=</span> <span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;estimates when c=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
               <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
               <span class="n">ec</span> <span class="o">=</span> <span class="n">ALMOST_BLACK_V</span>
              <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;estimate, $\hat</span><span class="si">{s}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">scx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">scy</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mf">0.05</span><span class="o">*</span><span class="n">scx</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">scy</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">ALMOST_BLACK_V</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">headwidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
            <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">finalize</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isSaveFigures</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figures/s_hat_PCR_s</span><span class="si">{}</span><span class="s1">_c</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Unpublished-notes:-fix-PTS-and-vary-parameters">Unpublished notes: fix PTS and vary parameters<a class="anchor-link" href="#Unpublished-notes:-fix-PTS-and-vary-parameters"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We know that we have
$$PTS = \frac{2 n_{ab}}{n_a + n_b}$$</p>
<p>If we fix $PTS=0.5$, then we have $\frac{1}{2} = \frac{2 n_{ab}}{n_a + n_b}$ and this means that 
$$n_a + n_b = 4 n_{ab}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fixedpts_nab</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">41</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">shat</span><span class="p">[</span><span class="n">na</span><span class="p">,</span><span class="mi">80</span><span class="o">-</span><span class="n">na</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

 


    </main>
    